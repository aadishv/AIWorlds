import os
import datetime
import time
import cv2

from inference import InferenceEngine

def run_eval(process_image) -> str:
    IMAGES = [
        "DSC05527_JPG.rf.1dc38151cc9cb5b70ebc3f3c8f2c9061.jpg",
        "DSC05527_JPG.rf.857f05dd031761433f006fcff38fd7d6.jpg",
        "DSC05527_JPG.rf.e93810be910dc220a82df9f57b84d1e6.jpg",
        "DSC05529_JPG.rf.4f3713360f6ffd96b6f246b0a98f7ecc.jpg",
        "DSC05529_JPG.rf.62abad02ff6e1e6496779e29f41414e7.jpg",
        "DSC05529_JPG.rf.b2794e72e9c127da672c08c141e0f493.jpg",
        "DSC05532_JPG.rf.939ade46604c88a80790f0602780d083.jpg",
        "DSC05532_JPG.rf.e2c1102d501f88ecc85c72c17db12d7e.jpg",
        "DSC05532_JPG.rf.f57277875049591287667b44c6c77018.jpg",
        "DSC05533_JPG.rf.1f1843c77dcf455bf7c36df857f4fe6d.jpg",
        "DSC05533_JPG.rf.2cedaa5fff0ffa47bba8d2d3ccceebb8.jpg",
        "DSC05533_JPG.rf.5588a1d44548dda85e44f561128ce0ff.jpg",
        "DSC05536_JPG.rf.182cfdc5e8f70d3b8c6e1c73c4fd5540.jpg",
        "DSC05536_JPG.rf.33276414c793dbf3f438476240d3e7d9.jpg",
        "DSC05536_JPG.rf.936bc4fb50341772d15238a9af532632.jpg",
        "DSC05537_JPG.rf.1c19f7e2ad800812357240bf8a48f0a6.jpg",
        "DSC05537_JPG.rf.540553851006eae3f0001ca644aa3e8c.jpg",
        "DSC05537_JPG.rf.bb82406713816127048502a6ab2fcb33.jpg",
        "DSC05539_JPG.rf.2fdfbc009677d88ebdbc7fff5f3b1ad9.jpg",
        "DSC05539_JPG.rf.5e68159a6a81bbdd79e81774f2302c00.jpg",
        "DSC05539_JPG.rf.863b266570b6cd231b747781c5d86a53.jpg",
        "DSC05540_JPG.rf.2c0ef7e242b6eaae9163b1e8b1f16d73.jpg",
        "DSC05540_JPG.rf.51b102300801d80d61444ce4a898638f.jpg",
        "DSC05540_JPG.rf.e46fc19afa04514588eeda7a4fe704a0.jpg",
        "DSC05542_JPG.rf.5a7adca4f1fcc97534265644caf4a11f.jpg",
        "DSC05542_JPG.rf.663dccdb7aa40a8816dc4e320354d836.jpg",
        "DSC05542_JPG.rf.9fe892b51f7c026e2102a74841d80929.jpg",
        "DSC05543_JPG.rf.394d6d56005bdbb5ce90c415f977810d.jpg",
        "DSC05543_JPG.rf.b6c1ea974c2d7ffce637ca66f37aa543.jpg",
        "DSC05543_JPG.rf.ed01c56cb5c24894b21c4692117de954.jpg",
        "DSC05544_JPG.rf.492a5e7404c4ae99384aa878fdf5be1f.jpg",
        "DSC05544_JPG.rf.94b92f1200ea6e1ea187741a247731b1.jpg",
        "DSC05544_JPG.rf.b930e2a4e28d0e84ad6e228cd82cf8c9.jpg",
        "DSC05548_JPG.rf.8f8fdc3da995fa98bef035acf6881c09.jpg",
        "DSC05548_JPG.rf.b7814ad616e20f6a6112bce6f0af895b.jpg",
        "DSC05548_JPG.rf.ebb726484cc1c8192fdc5563d09ae830.jpg",
        "DSC05551_JPG.rf.19319df32191876bba7b3faf22058682.jpg",
        "DSC05551_JPG.rf.9932cff296f70505017079bc2ef1d3e1.jpg",
        "DSC05551_JPG.rf.d7848e9e98c0facfffd1389c7dccf81a.jpg",
        "DSC05552_JPG.rf.4e8b5ae5ad5d7cb2736da150bcbce15a.jpg",
        "DSC05552_JPG.rf.b97281d9c04bc9a13e84777ed8314c24.jpg",
        "DSC05552_JPG.rf.fe5daab9832f5752b2190a050b09884f.jpg",
        "DSC05553_JPG.rf.3bf439effbb0d3c297a05bc2b19058c8.jpg",
        "DSC05553_JPG.rf.92c9cb83ed8e22e3e2a319e79ee64c50.jpg",
        "DSC05553_JPG.rf.af15b8b0bb9c9c21066974fd3dca38dc.jpg",
        "DSC05554_JPG.rf.1f1d92a5c47bc77b0e5fd46345e4e19a.jpg",
        "DSC05554_JPG.rf.21e32dd08bd4122d6b45c38a4ae86b87.jpg",
        "DSC05554_JPG.rf.b107da3b0c4931ab2b819b2363a8dbd9.jpg",
        "DSC05557_JPG.rf.6c3eb362962cd40d989e345400b08c5a.jpg",
        "DSC05557_JPG.rf.c39112f002775d3485a25c5c3dddc6cb.jpg",
        "DSC05557_JPG.rf.d5d6e841cedb52118b792ca72e0525f0.jpg",
        "DSC05559_JPG.rf.142874a226c512d39021bcbb06610b21.jpg",
        "DSC05559_JPG.rf.56bff2ed3fc1dd620eb33a77b8d5759b.jpg",
        "DSC05559_JPG.rf.e5677d37a10f209b399d0fa35a1683b4.jpg",
        "DSC05561_JPG.rf.417f20574ed9f2e14eed29cf91b18afa.jpg",
        "DSC05561_JPG.rf.5109885231864f783fbdd0f1e41cdf7d.jpg",
        "DSC05561_JPG.rf.6b77b784ff24e30903b89ed2c9e234cb.jpg",
        "DSC05563_JPG.rf.c80df39edeea6014497d8166f43cfdae.jpg",
        "DSC05563_JPG.rf.d01d7055b140d9b1471866b836c555f3.jpg",
        "DSC05563_JPG.rf.d175d6abe2e74ff4d4ac6bb79d58f76d.jpg",
        "DSC05564_JPG.rf.03acaa0f5626eb3eaab28b315aefdf00.jpg",
        "DSC05564_JPG.rf.808548e58301c6a67993444656c92df7.jpg",
        "DSC05564_JPG.rf.d67d02ce40857c603d7dfccae3193a89.jpg",
        "DSC05565_JPG.rf.0f83ede81256a0b1949616086557c117.jpg",
        "DSC05565_JPG.rf.27420a8bc7ab03ade022bc77acefb735.jpg",
        "DSC05565_JPG.rf.5cd9da45033aa18551f2cff875107ea3.jpg",
        "DSC05566_JPG.rf.0cf5b9847facee2e4aa89f13dd8365a2.jpg",
        "DSC05566_JPG.rf.21f3b218583c8c5613b05a9b93d3d23a.jpg",
        "DSC05566_JPG.rf.2d80aa7b0f78fd2729dba97d2ccdeb9f.jpg",
        "DSC05568_JPG.rf.1c53e328459ff33836d995a95d845456.jpg",
        "DSC05568_JPG.rf.6260c70c753d33d184a4cab5f552f194.jpg",
        "DSC05568_JPG.rf.ca90ce82b91465905325840846199923.jpg",
        "DSC05569_JPG.rf.8288bf4781aff9f28607e4eda6f47ead.jpg",
        "DSC05569_JPG.rf.872cb8ea211831fa8678a8d4ae6d7a15.jpg",
        "DSC05569_JPG.rf.e51e1ba3fab2c9e4ab46ff85d0516d98.jpg",
        "DSC05570_JPG.rf.3256580a5c9bbbb2428b551686f6ff99.jpg",
        "DSC05570_JPG.rf.75a4e78de1998f9466eae3e8a7baee57.jpg",
        "DSC05570_JPG.rf.dc777919732213a4332868ea177ef0fa.jpg",
        "DSC05571_JPG.rf.6d773808ecb110b2fa93d586f7024657.jpg",
        "DSC05571_JPG.rf.6de72ccfe146e4a2ceceb7987d5253c2.jpg",
        "DSC05571_JPG.rf.cee56da64e720622dcb06f8d21889f6f.jpg",
        "DSC05574_JPG.rf.4843581250199a0db5cd3f6d6b45798b.jpg",
        "DSC05574_JPG.rf.56bb49a2bc9f73b60f432545d7829b99.jpg",
        "DSC05574_JPG.rf.8e912da9a3d943c6733e4dd3e2f65d7f.jpg",
        "gateway_mp4-0001_jpg.rf.1ff85b1309b22872eada5bb76c6f44fe.jpg",
        "gateway_mp4-0001_jpg.rf.7253ad6d723ca62a8d2496756177b62a.jpg",
        "gateway_mp4-0001_jpg.rf.97cd53e6044af3b3c37079e6c41e7387.jpg",
        "gateway_mp4-0003_jpg.rf.29ecdb161836e533cb0c393f203be0c6.jpg",
        "gateway_mp4-0003_jpg.rf.71ac5e9ebe97dd134267c3e2e48925bc.jpg",
        "gateway_mp4-0003_jpg.rf.a0843b2b16cc5c45aaf6e778e1039c3b.jpg",
        "gateway_mp4-0014_jpg.rf.07ec1ae480e01f06fff05057a140465d.jpg",
        "gateway_mp4-0014_jpg.rf.081c7cddad25b5ea2a43ca8a98547f17.jpg",
        "gateway_mp4-0014_jpg.rf.993123fd7290d7dd03be232ad7c2556c.jpg",
        "gateway_mp4-0018_jpg.rf.47c9b8a1027a9530b62052bbe7c867c2.jpg",
        "gateway_mp4-0018_jpg.rf.601ffdd1bb0a32448e5e0496128d6ded.jpg",
        "gateway_mp4-0018_jpg.rf.e308a5223f03b40340d814e2715ec243.jpg",
        "gateway_mp4-0027_jpg.rf.2978313cd5b7400fb09f4b897ae21831.jpg",
        "gateway_mp4-0027_jpg.rf.3ce3c6c2c1955798055fdd16c7e3fc2b.jpg",
        "gateway_mp4-0027_jpg.rf.cb4e42e8cd8e973f14f7b863ffb197cc.jpg",
        "gateway_mp4-0032_jpg.rf.435db50e5fc95fa06a8168b7c374e2ab.jpg",
        "gateway_mp4-0032_jpg.rf.4568b31b6ff57a0fc86686cc737e87a9.jpg",
        "gateway_mp4-0032_jpg.rf.7401f52219784e039f0c4d0187803001.jpg",
        "gateway_mp4-0039_jpg.rf.07da19c890088a3e78b600dc31d49cc3.jpg",
        "gateway_mp4-0039_jpg.rf.12def02dd8a2d5df48da88e4d829d158.jpg",
        "gateway_mp4-0039_jpg.rf.556ad8e6e73c357f773bb0827540cb13.jpg",
        "IMG_5530_jpg.rf.6198aa97024b1af701731926b14f62d7.jpg",
        "IMG_5530_jpg.rf.82e3c295a466eb67ab49aa2f52c2b6a8.jpg",
        "IMG_5530_jpg.rf.d21be477eb78e988457a06d72d8a3501.jpg",
        "IMG_5531_jpg.rf.091ab34ae98573b73878321951336112.jpg",
        "IMG_5531_jpg.rf.3cffd9a17922239a1896b8ba8130d868.jpg",
        "IMG_5531_jpg.rf.d4c446b847a2439707c424caf3ea3df7.jpg",
        "IMG_5532_jpg.rf.1481c9b54d74f781dc32e59b6c18e4be.jpg",
        "IMG_5532_jpg.rf.53b8dd2112b6414683e6e43f12cf87e0.jpg",
        "IMG_5532_jpg.rf.615e7d94a832846185c53e88474b2dbb.jpg",
        "IMG_5534_jpg.rf.590b892cdeb4b95be6b0f9f3ebd22cf2.jpg",
        "IMG_5534_jpg.rf.5fe3384300f422c3f8602f3c8c4d83ab.jpg",
        "IMG_5534_jpg.rf.a9383cfa01741511a40df0a2cbdfaa8d.jpg",
        "IMG_5536_jpg.rf.97e19306a54fc4e44b18a2ed3a9a1ef6.jpg",
        "IMG_5536_jpg.rf.b588138e02b68f5d5c3bbf81b4b84ba1.jpg",
        "IMG_5536_jpg.rf.ee795090d20980a57bd3a5ddde1fb0a0.jpg",
        "video_mp4-0000_jpg.rf.37196aca18ace4bad7a62a3007a79931.jpg",
        "video_mp4-0000_jpg.rf.7311cc4acbd89472b3ed5460da8830b2.jpg",
        "video_mp4-0000_jpg.rf.d16d31dee63e4d272bdfd9eb163ef265.jpg",
        "video_mp4-0002_jpg.rf.0fee5135b33bed83fac66e60ed41294c.jpg",
        "video_mp4-0002_jpg.rf.1a7ea5d180392fc0cdd0fb53f05dd9be.jpg",
        "video_mp4-0002_jpg.rf.8404d433b3bfcfb0cd866f79c1d9e4bb.jpg",
        "video_mp4-0003_jpg.rf.715f7073c2d49a72758d0fad17671a67.jpg",
        "video_mp4-0003_jpg.rf.9bc91ce1f2b3f7a03cf50b7ef3d34f50.jpg",
        "video_mp4-0003_jpg.rf.e98d755215a2a402db6d762bd852d071.jpg",
        "video_mp4-0004_jpg.rf.68fc131802c5102d777c7cf526665a2a.jpg",
        "video_mp4-0004_jpg.rf.8271ab945740e056803563b0ab97c923.jpg",
        "video_mp4-0004_jpg.rf.9dbb6e9b397c37560b27c22fc2b26eeb.jpg",
        "video_mp4-0005_jpg.rf.29838c8137c2c82a84fb9a3f9967ab4f.jpg",
        "video_mp4-0005_jpg.rf.c2596184d1eb191f78d2c1c71bb097bd.jpg",
        "video_mp4-0005_jpg.rf.c8e0f5f7756f0a85fc634b9033db2fff.jpg",
        "video_mp4-0006_jpg.rf.0eb554421a459c249cdcfee51a0b5afd.jpg",
        "video_mp4-0006_jpg.rf.504ff4a1e71d80d498500a401384a15e.jpg",
        "video_mp4-0006_jpg.rf.c3f63d9782db3f16fcd0727484b48a83.jpg",
        "video_mp4-0007_jpg.rf.41f48d9377a4616c4b5e74f62735f2ee.jpg",
        "video_mp4-0007_jpg.rf.4a1a9943ad3b6d66f7f28018b6e635b6.jpg",
        "video_mp4-0007_jpg.rf.dabeb413af944ebc01f53bafd91f6c7c.jpg",
        "video_mp4-0008_jpg.rf.b740ceb6e68c50f878a2a0479470e0f0.jpg",
        "video_mp4-0008_jpg.rf.c5e22cf63b522993ceb75654e1b52908.jpg",
        "video_mp4-0008_jpg.rf.fea6c8967614dce181be63f3eaa1a53e.jpg",
        "video_mp4-0009_jpg.rf.5fb3b55e36df03352418433dac3c4264.jpg",
        "video_mp4-0009_jpg.rf.af68ae4b499bf6785572b94568b71ad3.jpg",
        "video_mp4-0009_jpg.rf.de1e7c6faeaf95d5e880a2c14165ca50.jpg",
        "video_mp4-0010_jpg.rf.0aab80deae9b16185c22272ecf7ea936.jpg",
        "video_mp4-0010_jpg.rf.2dafed33a4b8a7402eb443bc78cf7816.jpg",
        "video_mp4-0010_jpg.rf.e05834fa1503f7f4eade7f00aaa4a549.jpg",
        "video_mp4-0011_jpg.rf.5cf541200c2f59db9c20896648d1459e.jpg",
        "video_mp4-0011_jpg.rf.7ee3f027bf86bdc75f1dded2732d3de6.jpg",
        "video_mp4-0011_jpg.rf.91920068f5cd015c4daf9a0dcec7a8b8.jpg",
        "video_mp4-0013_jpg.rf.3ec2cfd1e833607398e8f9414f013792.jpg",
        "video_mp4-0013_jpg.rf.98cb7d823582a7c907a8389d0afb61e4.jpg",
        "video_mp4-0013_jpg.rf.cb40445f00e30f93ce5ee2d8047c2a8a.jpg",
        "video_mp4-0015_jpg.rf.6c82b7ef9180641ccf5f38289e3f975c.jpg",
        "video_mp4-0015_jpg.rf.9d3187d39e0da905cbf0b00be31c6a2a.jpg",
        "video_mp4-0015_jpg.rf.c77e279e99365dd354bee38b5fca6b9d.jpg",
        "video_mp4-0016_jpg.rf.41298f3384097e536d7871d67cf55b39.jpg",
        "video_mp4-0016_jpg.rf.8e3aa385a6bb8e5fd586057b29abfae7.jpg",
        "video_mp4-0016_jpg.rf.eebaf6b05a25af02b75d17cbb3a29f7c.jpg",
        "video_mp4-0018_jpg.rf.89824d9f3da3a0db4cf6b55e3d805651.jpg",
        "video_mp4-0018_jpg.rf.95f4d40b54675d8f195af706134e6fdd.jpg",
        "video_mp4-0018_jpg.rf.ffea5772dacab095fceb394ef9de4583.jpg",
        "video_mp4-0020_jpg.rf.4d2435dda995dd93432674c5011b3ef3.jpg",
        "video_mp4-0020_jpg.rf.edfbcc1fccb636fb326ae001dc75b726.jpg",
        "video_mp4-0020_jpg.rf.eed6cd24b9fdc5ba06ded2f56429e247.jpg",
        "video_mp4-0021_jpg.rf.4e0b21a32fd2d6a63ba9c7677aa93765.jpg",
        "video_mp4-0021_jpg.rf.563dfffa491bbb6cd0db6ab98d62392f.jpg",
        "video_mp4-0021_jpg.rf.fedf30ef0a60a206d8c608749f6c9444.jpg",
        "video_mp4-0023_jpg.rf.ad755c0915a07622c5fe8ca80bac6267.jpg",
        "video_mp4-0023_jpg.rf.d3d402473b388857d09a34278e323139.jpg",
        "video_mp4-0023_jpg.rf.ec21073c38ed7450aa4599a6dcef7cf3.jpg",
        "video_mp4-0025_jpg.rf.75052bf7184f9ded926e0fccf62b321f.jpg",
        "video_mp4-0025_jpg.rf.830def5f6499d793c4d2b9bfffcecb03.jpg",
        "video_mp4-0025_jpg.rf.ad73e2c7b39f464b396d19d696e0c8a6.jpg",
        "video_mp4-0026_jpg.rf.596e03365fe81a5a3e7b31b8c6978c14.jpg",
        "video_mp4-0026_jpg.rf.c1235ac254f3e93a7b11d6960be9520c.jpg",
        "video_mp4-0026_jpg.rf.e9ea6dc4b10131cda18cf5514be971b0.jpg",
        "video_mp4-0028_jpg.rf.4f0cbb01a701bb50db44c54cffeb6a61.jpg",
        "video_mp4-0028_jpg.rf.a84f8ff964d7ebd9df5aedb4537d23b0.jpg",
        "video_mp4-0028_jpg.rf.f12a0b854326a566fd97c6b151cdf057.jpg",
        "video_mp4-0029_jpg.rf.0622ad4d633178391c6b26de95f1563c.jpg",
        "video_mp4-0029_jpg.rf.4090f2e0041249650b731718771b320d.jpg",
        "video_mp4-0029_jpg.rf.4c60777c02c2fd2493af59e7923b3fb5.jpg",
        "video_mp4-0030_jpg.rf.1290cd86efea44e176b85d4f56f45ce9.jpg",
        "video_mp4-0030_jpg.rf.e96f9eb9d142c8a5581de89cb430fa82.jpg",
        "video_mp4-0030_jpg.rf.ece2dd2089768e69b57a4bb14432fb18.jpg",
        "video_mp4-0031_jpg.rf.05a7be56a4e5a1ed18e8dfdcd13dcca1.jpg",
        "video_mp4-0031_jpg.rf.d890e93de1247a578e3387ea9fe4f0fd.jpg",
        "video_mp4-0031_jpg.rf.fc9993484a03d0989d326dd14ade5305.jpg",
        "video_mp4-0036_jpg.rf.208f883edbc44585a6cbe3448f01ca10.jpg",
        "video_mp4-0036_jpg.rf.281b493bb9f77a4f2ac0feb56d08592d.jpg",
        "video_mp4-0036_jpg.rf.aa54f542d2acb6ded270c77e74a7aaaf.jpg",
        "video_mp4-0038_jpg.rf.9d78bef3355f6b925ba5941f21e09cc0.jpg",
        "video_mp4-0038_jpg.rf.ba88930f85b938a1c500b9c1cedb35bc.jpg",
        "video_mp4-0038_jpg.rf.cb99a794ecb1cd19a757272fb7e7e8ca.jpg",
        "video_mp4-0039_jpg.rf.260b06ab2c2e57ae3038d33bd0d2d978.jpg",
        "video_mp4-0039_jpg.rf.2e3a42663b83336e30b21fa7a250a8a7.jpg",
        "video_mp4-0039_jpg.rf.96794ce5d7ad58f643b9fa94dd6b4dd1.jpg",
        "video_mp4-0042_jpg.rf.2e40670e35c9ddc2b3a27aa661f72637.jpg",
        "video_mp4-0042_jpg.rf.906531b9b301ea98f948eb4070d67f02.jpg",
        "video_mp4-0042_jpg.rf.f7ab378edec890ae14f8ec55f158f23a.jpg",
        "video_mp4-0043_jpg.rf.d2be9bc0b8d45ad9a7a45b6aba478883.jpg",
        "video_mp4-0043_jpg.rf.db8a94094396a1ec08f54dbf899c0290.jpg",
        "video_mp4-0043_jpg.rf.f0ef9d6acf687245b4a596d194fc6344.jpg",
    ]

    start = time.time()
    for i in range(len(IMAGES)):
        print(f"Processing image {i+1}/{len(IMAGES)}")
        process_image(f'/home/aadish/AIWorlds/eval/eval_images/{IMAGES[i]}')
    start = time.time() - start
    output_text = f"\nEval on {datetime.datetime.now()}\n"
    output_text += f"Total time taken: {start:.2f} seconds for {len(IMAGES)} images\n"
    output_text += f"Average time per image: {start/len(IMAGES):.2f} seconds\n"
    output_text += f"Images per second: {len(IMAGES)/start:.2f}\n"

    print(output_text, end="")
    path = './eval_output.txt'
    os.system('echo "' + output_text.replace('\n',
              '\\n') + f'" >> {path}')

if __name__ == "__main__":
    with InferenceEngine("/home/aadish/AIWorlds/comp2/yolov5n-best.engine") as engine:
        def process_image(i):
            engine.run(cv2.imread(i))
        run_eval(process_image)
